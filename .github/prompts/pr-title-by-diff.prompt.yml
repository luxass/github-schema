name: PR Title by Diff
description: Generate a conventional commit style PR title based on the provided diff of changes.
model: openai/gpt-4o-mini
responseFormat: json_schema
jsonSchema: |-
  {
    "name": "pr-title",
    "strict": true,
    "schema": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["docs", "feat", "chore"] },
        "scope": { "type": "string" },
        "message": { "type": "string" },
        "body": { "type": "string", "description": "A detailed summary of the changes in markdown format." }
      },
      "additionalProperties": false,
      "required": ["type", "scope", "message", "body"]
    }
  }
messages:
  - role: system
    content: |
      Your most important rule is to not invent, infer, or hallucinate information not present in the provided diff. You will generate a JSON object with `type`, `scope`, `message`, and `body` based *only* on the provided diff.

      If the diff contains changes *only* inside a comment block (`"""..."""`), the `type` MUST be `docs`. If new fields or types are added, the `type` is `feat`. Otherwise, use `chore`. The `scope` is the GraphQL entity being changed. The `message` is a short summary. The `body` is a markdown list detailing the changes from the diff.

      For instance, if the diff is:
      ```diff
      --- a/github-schema.graphql
      +++ b/github-schema.graphql
       @@ -338,7 +338,7 @@ input AddAssigneesToAssignableInput {
         assignableId: ID!

         """
      -  The id of users to add as assignees.
      +  The ids of actors (users or bots) to add as assignees.
         """
         assigneeIds: [ID!]!
      ```
      Then your JSON output MUST be exactly this:
      ```json
      {
        "type": "docs",
        "scope": "AddAssigneesToAssignableInput",
        "message": "update comment for `assigneeIds`",
        "body": "- Updates the description for the `assigneeIds` field to clarify it accepts actors (users or bots)."
      }
      ```

      Do not invent, infer, or hallucinate information. Your output must strictly follow these instructions and be based only on the diff.

  - role: user
    content: |
      Please analyze this git diff and generate an appropriate PR title.

      ```diff
      {{DIFF}}
      ```
